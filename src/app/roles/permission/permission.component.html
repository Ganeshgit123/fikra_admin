<div class="container-fluid">
    <app-pagetitle title="Permissions" [breadcrumbItems]="breadCrumbItems"></app-pagetitle>
    <div class="card">
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label>Role Title</label>
                        <select class="form-control" (click)="roleClick($event.target.value)">
                            <option selected disabled>Select Role</option>
                            <option *ngFor="let item of roleData" value="{{item._id}}">{{item.roleName}}</option>
                        </select>
                    </div>
                </div>
            </div>
            <p class="text-right" *ngIf="isRoleClick"><button type="button"
                    class="btn btn-primary w-md waves-effect waves-light"
                    (click)="viewPermission(permissionModel)">Permission</button></p>
            <ng-template #permissionModel let-modal>
                <div class="modal-header">
                    <button type="button" class="close" (click)="modal.dismiss('Cross click')"
                        aria-hidden="true">×</button>
                </div>
                <div class="modal-body">
                    <div class="table-responsive">
                        <table id="basic-datatable"
                            class="table table-bordered dt-responsive nowrap no-footer dtr-inline">
                            <thead>
                                <tr>
                                    <th>Permission Name</th>
                                    <th>Read</th>
                                    <th>Wirte</th>
                                    <th>Admin Approval</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let item of permissionData">
                                    <td>{{item.permissionName}}</td>
                                    <td>
                                        <label class="switch">
                                            <input *ngIf="item.read == true" type="checkbox" checked
                                                (change)="read_update_change($event,item.permissionId,item.write,item._with_Approval_)">
                                            <input *ngIf="item.read !== true" type="checkbox" unchecked
                                                (change)="read_update_change($event,item.permissionId,item.write,item._with_Approval_)">
                                            <span class="slider"></span>
                                        </label>
                                    </td>
                                    <td>
                                        <label class="switch">
                                            <input *ngIf="item.write == true" type="checkbox" checked
                                                (change)="write_update_change($event,item.permissionId,item.read)">
                                            <input *ngIf="item.write !== true" type="checkbox" unchecked
                                                (change)="write_update_change($event,item.permissionId,item.read)">
                                            <span class="slider"></span>
                                        </label>
                                    </td>
                                    <td>{{item._with_Approval_}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </ng-template>
            <div class="table-responsive" *ngIf="isRoleClick">
                <table id="basic-datatable" class="table table-bordered dt-responsive nowrap no-footer dtr-inline">
                    <thead>
                        <tr>
                            <th>Name Of User</th>
                            <th>Email</th>
                            <th>From Time</th>
                            <th>To Time</th>
                            <th>Update Time</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of userList">
                            <td>{{item.systemAdminName}}</td>
                            <td>{{item.systemAdminUserName}}</td>
                            <td>{{item.timeFrom}}</td>
                            <td>{{item.timeTo}}</td>
                            <td>
                                <a class="mr-3 text-info" ngbTooltip="Edit" (click)="viewTime(item,timeChangeModel)"><i
                                        class="mdi mdi-pencil font-size-18"></i></a>
                                <ng-template #timeChangeModel let-modal>
                                    <div class="modal-header">
                                        <button type="button" class="close" (click)="modal.dismiss('Cross click')"
                                            aria-hidden="true">×</button>
                                    </div>
                                    <div class="modal-body">
                                        <form [formGroup]="changeTime">
                                            <div class="form-group">
                                                <label>Time From</label>
                                                <input class="form-control" type="time" formControlName="timeFrom">
                                            </div>
                                            <div class="form-group">
                                                <label>Time To</label>
                                                <input class="form-control" type="time" formControlName="timeTo">
                                            </div>
                                            <br>
                                            <p class="text-center"><button type="button"
                                                    class="btn btn-primary w-md waves-effect waves-light"
                                                    (click)="onTimeSubmit()">Save</button></p>
                                        </form>
                                    </div>
                                </ng-template>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>


</div>