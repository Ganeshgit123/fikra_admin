<div class="container-fluid">
<app-pagetitle title="Projects" [breadcrumbItems]="breadCrumbItems"></app-pagetitle>

<div class="row">
<div class="col-12">
<div class="card">
<div class="card-body">
<div class="row mb-md-2">
<!-- <div class="col-sm-12 col-md-2">
<div class="dataTables_length" id="tickets-table_length"><label
class="d-inline-flex align-items-center">Show
<select name="tickets-table_length" aria-controls="tickets-table" name="pageSize"
[(ngModel)]="pageSize"
class="custom-select custom-select-sm form-control form-control-sm mx-2">
<option [ngValue]="10">10</option>
<option [ngValue]="25">25</option>
<option [ngValue]="50">50</option>
<option [ngValue]="100">100</option>
</select> entries</label></div>
</div> -->
<!-- <div class="col-sm-12 col-md-6">
<div class="form-group row">
<label for="example-date-input" class="col-md-2 col-form-label text-center">Start Date</label>
<div class="col-md-4">
<input class="form-control" type="date" value="2019-08-19" id="example-date-input">
</div>
<label for="example-date-input1" class="col-md-2 col-form-label text-center">End Date</label>
<div class="col-md-4">
<input class="form-control" type="date" value="2019-08-19" id="example-date-input1">
</div>
</div>
</div> -->
<!-- Search -->
<!-- <div class="col-sm-12 col-md-4">
<div id="tickets-table_filter" class="dataTables_filter text-md-right"><label
class="d-inline-flex align-items-center">Search:
<input type="text" name="searchTerm" class="form-control form-control-sm ml-2"
aria-controls="tickets-table"></label></div>
</div> -->
<!-- End search -->
</div>
<!-- Table -->
<div class="table-responsive">
<table id="basic-datatable"
class="table table-bordered dt-responsive text-nowrap  no-footer dtr-inline">
<thead>
<tr>
 <!-- <th>Select</th> -->
<th>Project Title</th>
<th>Category</th>
<th>Launch Date</th>
<th>User Name</th>
<th>Goal Amount</th>
<th>Remaining Duration</th>
<th>Admin Approval</th>
<th *ngIf="showAccept === true">Action</th>
</tr>
</thead>
<tbody>
<tr *ngFor="let proj of projectList  | filter:searchTerm">
<!-- <td>
   <p class="text-center"><input  type="checkbox" value="" >
</td> -->
<td><a routerLink="/view-projects/{{ proj._id}}">{{proj.title}}</a></td>
<td>{{proj.basicInfoId.categoryName}}</td>
<td>{{proj.basicInfoId.launchDate | date}}</td>
<td><a routerLink="/view-creators/{{proj.userId._id}}">{{proj.userId.userName}}</a></td>
<td>{{proj.basicInfoId.goalAmount}}</td>
<td>{{proj.finalDate}} days</td>

<td *ngIf="showAccept === true">
<select class="pend_btn" *ngIf="proj.aproval_Status === 'pending'" (change)="onChangeProjStatus(proj._id,$event.target.value,centerDataModal)">
<option>{{proj.aproval_Status}}</option>
<option>approved</option>
<option>under_review</option>
<option>rejected</option>
</select>
<select class="apprve_btn" *ngIf="proj.aproval_Status === 'approved'" (change)="onChangeProjStatus(proj._id,$event.target.value,centerDataModal)">
<option>{{proj.aproval_Status}}</option>
<option>rejected</option>
</select>
<select class="review_btn" *ngIf="proj.aproval_Status === 'under_review'" (change)="onChangeProjStatus(proj._id,$event.target.value,centerDataModal)">
<option>{{proj.aproval_Status}}</option>
<option>approved</option>
<option>rejected</option>
</select>
<select class="reject_btn" *ngIf="proj.aproval_Status === 'rejected'" (change)="onChangeProjStatus(proj._id,$event.target.value,centerDataModal)">
<option>{{proj.aproval_Status}}</option>
</select>
<span *ngIf="proj.aproval_Status === 'rejected'">
   <p style="margin: 10px 0;"><strong>Reject Reason:</strong></p>
   <p>  {{proj.rejection_comment}}</p>
</span>
</td>
<td *ngIf="showAccept !== true">{{proj.aproval_Status}}</td>

<td>
   <a *ngIf="showAccept === true" routerLink="/add_new_bill/proj-{{ proj._id}}//{{proj.userId._id}}" style="padding-right: 10px;">Create Invoice</a>

   <a *ngIf="showAccept === true" class="text-danger text-info" ngbTooltip="Delete" (click)="deleteProject(proj._id)"><i
     class="mdi mdi-trash-can font-size-18"></i></a>
 </td>
</tr>
</tbody>
</table>
</div>
<!-- End table -->
<div class="row justify-content-md-between align-items-md-center mt-2">
<!-- <div class="col-sm-12 col-md-5">
<div class="dataTables_info mb-2" id="tickets-table_info" role="status" aria-live="polite">Showing
{{startIndex}} to
{{endIndex}} of {{totalRecords}}
entries
</div>
</div> -->
<!-- Pagination -->
<div class="col-sm-12 col-md-5">
<div class="text-md-right float-md-right pagination-rounded">
<!-- <ngb-pagination [collectionSize]="total$ | async" [(page)]="page" [pageSize]="pageSize">
</ngb-pagination> -->
</div>
</div>
<!-- End Pagination -->
</div>
</div>
</div>
</div>
</div>
</div>

<ng-template #centerDataModal let-modal>
<div class="modal-header">
<h5 class="modal-title mt-0">Rejection Reason</h5>
<button type="button" class="close" (click)="modal.dismiss('Cross click')" aria-hidden="true">Ã—</button>
</div>
<div class="modal-body">
<form [formGroup]="addComment">
<div class="form-group">
<label>Reason</label>
<textarea class="form-control" formControlName="rejection_comment"></textarea>
</div>
<br>
<p class="text-center"><button type="button" class="btn btn-primary w-md waves-effect waves-light" (click)="rejectReason()">Save</button></p>
</form>
</div>
</ng-template>